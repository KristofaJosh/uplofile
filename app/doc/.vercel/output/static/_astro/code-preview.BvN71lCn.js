import{a as i}from"./index.B28oNxVQ.js";var T={exports:{}},P={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var V;function K(){if(V)return P;V=1;var r=Symbol.for("react.transitional.element"),s=Symbol.for("react.fragment");function t(n,o,a){var d=null;if(a!==void 0&&(d=""+a),o.key!==void 0&&(d=""+o.key),"key"in o){a={};for(var g in o)g!=="key"&&(a[g]=o[g])}else a=o;return o=a.ref,{$$typeof:r,type:n,key:d,ref:o!==void 0?o:null,props:a}}return P.Fragment=s,P.jsx=t,P.jsxs=t,P}var $;function ee(){return $||($=1,T.exports=K()),T.exports}var e=ee();function te(r,s){typeof r=="function"?r(s):r!=null&&(r.current=s)}function re(...r){return s=>r.forEach(t=>te(t,s))}var M=i.forwardRef((r,s)=>{const{children:t,...n}=r,o=i.Children.toArray(t),a=o.find(ne);if(a){const d=a.props.children,g=o.map(m=>m===a?i.Children.count(d)>1?i.Children.only(null):i.isValidElement(d)?d.props.children:null:m);return e.jsx(D,{...n,ref:s,children:i.isValidElement(d)?i.cloneElement(d,void 0,g):null})}return e.jsx(D,{...n,ref:s,children:t})});M.displayName="Slot";var D=i.forwardRef((r,s)=>{const{children:t,...n}=r;if(i.isValidElement(t)){const o=oe(t);return i.cloneElement(t,{...le(n,t.props),ref:s?re(s,o):o})}return i.Children.count(t)>1?i.Children.only(null):null});D.displayName="SlotClone";var se=({children:r})=>e.jsx(e.Fragment,{children:r});function ne(r){return i.isValidElement(r)&&r.type===se}function le(r,s){const t={...s};for(const n in s){const o=r[n],a=s[n];/^on[A-Z]/.test(n)?o&&a?t[n]=(...g)=>{a(...g),o(...g)}:o&&(t[n]=o):n==="style"?t[n]={...o,...a}:n==="className"&&(t[n]=[o,a].filter(Boolean).join(" "))}return{...r,...t}}function oe(r){let s=Object.getOwnPropertyDescriptor(r.props,"ref")?.get,t=s&&"isReactWarning"in s&&s.isReactWarning;return t?r.ref:(s=Object.getOwnPropertyDescriptor(r,"ref")?.get,t=s&&"isReactWarning"in s&&s.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}const ae=()=>Math.random().toString(36).slice(2,10)+Date.now().toString(36).slice(-4),J=i.createContext(null),ie=({multiple:r=!0,initial:s=[],onChange:t,upload:n,removeMode:o="optimistic",onRemove:a,accept:d="image/*",name:g="images",maxCount:m,disabled:j,children:A})=>{const[h,S]=i.useState([]),k=i.useRef(new Map),v=i.useRef(new Map),R=i.useRef(null),L=i.useRef(!1);i.useEffect(()=>{if(L.current)return;const l=s??[];if(!Array.isArray(l)||l.length===0)return;const u=l.map(x=>({uid:x.uid||x.id,id:x.id,name:x.name,url:x.url,status:"done"}));S(x=>x.length===0?u:x),L.current=!0},[s]);const q=i.useMemo(()=>{const l=h.filter(u=>u.status==="done"&&u.url);return JSON.stringify(l.map(({uid:u,previewUrl:x,file:p,status:c,progress:f,error:U,...Q})=>Q))},[h]),b=i.useCallback(l=>{S(u=>{const x=typeof l=="function"?l(u):l;return t&&Promise.resolve(t(x)).catch(()=>{}),x})},[t]),O=i.useCallback(async l=>{if(!l.file)return;const u=new AbortController;k.current.set(l.uid,u);const x=p=>{b(c=>c.map(f=>f.uid===l.uid?{...f,progress:Math.max(0,Math.min(100,p))}:f))};b(p=>p.map(c=>c.uid===l.uid?{...c,status:"uploading",error:void 0}:c));try{const p=await n(l.file,u.signal,x);b(c=>c.map(f=>{if(f.uid!==l.uid)return f;if(f.previewUrl&&f.previewUrl.startsWith("blob:"))try{URL.revokeObjectURL(f.previewUrl)}catch{}const U=p?.preview||p.url;return{...f,status:"done",url:p.url,id:p.id,previewUrl:U,progress:100}}))}catch(p){const c=u.signal.aborted;b(f=>f.map(U=>U.uid===l.uid?{...U,status:c?"canceled":"error",error:c?void 0:p?.message||"Upload failed"}:U))}finally{k.current.delete(l.uid)}},[b,n]),z=i.useCallback(l=>{if(!l||l.length===0)return;const u=Array.from(l),x=m?Math.max(0,m-h.filter(f=>f.status!=="canceled").length):void 0,c=(typeof x=="number"?u.slice(0,x):u).map(f=>({uid:ae(),name:f.name,file:f,previewUrl:URL.createObjectURL(f),status:"idle",progress:0}));b([...h,...c]),c.forEach(f=>O(f))},[b,h,m,O]),Y=i.useCallback(l=>{z(l.target.files),l.currentTarget.value=""},[z]),G=i.useCallback(l=>{l.preventDefault(),!j&&z(l.dataTransfer.files)},[j,z]),X=i.useCallback(l=>l.preventDefault(),[]),Z=i.useMemo(()=>({cancel:l=>{k.current.get(l)?.abort()},remove:async l=>{const u=h.find(p=>p.uid===l);if(!u)return;if(k.current.get(l)?.abort(),!a||u.status!=="done"){b(p=>p.filter(c=>c.uid!==l));return}const x=new AbortController;if(v.current.set(l,x),o==="optimistic"){const p=h;b(c=>c.filter(f=>f.uid!==l));try{await a(u,x.signal)}catch{b(p)}finally{v.current.delete(l)}}else{b(p=>p.map(c=>c.uid===l?{...c,status:"removing"}:c));try{await a(u,x.signal),b(p=>p.filter(c=>c.uid!==l))}catch{b(p=>p.map(c=>c.uid===l?{...c,status:"done"}:c))}finally{v.current.delete(l)}}},retry:l=>{const u=h.find(x=>x.uid===l);u&&u.file&&O({...u,status:"idle",error:void 0,progress:0})}}),[b,h,a,o,O]);i.useEffect(()=>()=>{h.forEach(l=>l.previewUrl&&URL.revokeObjectURL(l.previewUrl)),k.current.forEach(l=>l.abort())},[]);const F={items:h,disabled:j,multiple:r,accept:d,actions:Z,openFileDialog:()=>R.current?.click(),fileInputProps:{ref:R,onChange:Y,accept:d,multiple:r,disabled:j},getDropzoneProps:()=>({role:"button",tabIndex:0,onDrop:G,onDragOver:X,onKeyDown:l=>{j||(l.key==="Enter"||l.key===" ")&&R.current?.click()},"data-disabled":j?"":void 0,"data-multiple":r?"":void 0}),hiddenInputValue:q,name:g};return e.jsx(J.Provider,{value:F,children:e.jsxs("div",{"data-part":"root",children:[e.jsx("input",{type:"file",hidden:!0,...F.fileInputProps}),A]})})},C=()=>{const r=i.useContext(J);if(!r)throw new Error("useUplofile hook must be used within <Uplofile.Root>");return r},ce=({asChild:r,...s})=>{const{getDropzoneProps:t}=C(),n=r?M:"div";return e.jsx(n,{"data-part":"dropzone",...t(),...s})},de=({render:r})=>{const{items:s,actions:t}=C();return r&&typeof r=="function"?r({items:s,actions:t}):e.jsx("div",{"data-part":"preview",className:"uplofile-preview",children:e.jsx("div",{className:"uplofile-preview__wrapper grid grid-cols-2 gap-3 sm:grid-cols-3 md:grid-cols-4",children:s.map(n=>e.jsxs("div",{onClick:o=>o.stopPropagation(),className:"uplofile-preview__item relative overflow-hidden rounded-xl border size-32","data-state":n.status,children:[n.url||n.previewUrl?e.jsx("img",{src:n.url||n.previewUrl,alt:n.name,className:"uplofile-preview__image size-full object-cover"}):e.jsx("div",{className:"uplofile-preview__no-preview flex h-32 w-full items-center justify-center text-xs text-gray-500",children:"No preview"}),n.status==="uploading"&&e.jsx("div",{className:"uplofile-preview__progress absolute bottom-0 left-0 right-0 h-1 bg-gray-200",children:e.jsx("div",{className:"uplofile-preview__progress-bar h-full bg-black/80",style:{width:`${Math.max(0,Math.min(100,n.progress??0))}%`}})}),e.jsxs("div",{className:"uplofile-preview__actions absolute inset-x-0 bottom-0 flex justify-end gap-2 bg-gradient-to-t from-black/60 to-transparent p-2",children:[n.status==="uploading"&&e.jsx("button",{type:"button",className:"uplofile-preview__button uplofile-preview__button--cancel rounded-xl bg-black/50 px-2 py-1 text-xs text-white",onClick:()=>t.cancel(n.uid),children:"Cancel"}),(n.status==="error"||n.status==="canceled")&&e.jsx("button",{type:"button",className:"uplofile-preview__button uplofile-preview__button--retry rounded-xl bg-black/50 px-2 py-1 text-xs text-white",onClick:()=>t.retry(n.uid),children:"Retry"}),e.jsx("button",{type:"button",className:"uplofile-preview__button uplofile-preview__button--remove rounded-xl bg-black/50 px-2 py-1 text-xs text-white",onClick:()=>t.remove(n.uid),disabled:n.status==="removing",children:n.status==="removing"?"Removing...":"Remove"})]})]},n.uid))})})},ue=({name:r})=>{const{hiddenInputValue:s,name:t}=C();return e.jsx("input",{type:"hidden",name:r??t,value:s})},pe=({uid:r,asChild:s,alwaysVisible:t=!1,...n})=>{const{actions:o,items:a}=C(),d=a.find(m=>m.uid===r)?.status==="uploading",g=s?M:"button";return!d&&!t?null:e.jsx(g,{onClick:m=>{m.stopPropagation(),o.cancel(r)},...n})},xe=({uid:r,asChild:s,...t})=>{const{actions:n}=C(),o=s?M:"button";return e.jsx(o,{onClick:a=>{a.stopPropagation(),n.retry(r)},...t})},fe=({uid:r,asChild:s,...t})=>{const{actions:n}=C(),o=s?M:"button";return e.jsx(o,{onClick:a=>{a.stopPropagation(),n.remove(r)},...t})},ge=({asChild:r,children:s,render:t,...n})=>{const{openFileDialog:o,disabled:a,items:d}=C(),g=r?M:"button",m=d.filter(v=>v.status==="uploading"),j=m.length,A=d.filter(v=>v.status==="done").length,h=d.filter(v=>v.status==="error").length,S=j?Math.round(m.reduce((v,R)=>v+(typeof R.progress=="number"?R.progress:0),0)/j):void 0,k={items:d,isUploading:j>0,uploadingCount:j,doneCount:A,errorCount:h,totalProgress:S,open:o};return e.jsx(g,{type:r?void 0:"button","aria-disabled":a,"data-part":"trigger",onClick:v=>{a||(n.onClick?.(v),o())},...n,children:t?t(k):s})},y=ie,_=ge,B=ue,me=ce,w=de,W=pe,I=xe,H=fe;async function N(r,s,t){return await new Promise((n,o)=>{let a=0;const d=Math.floor(Math.random()*400)+150,g=setInterval(()=>{a+=Math.floor(Math.random()*16)+5,t&&t(Math.min(99,a)),a>=100&&(clearInterval(g),n({url:URL.createObjectURL(r)}))},d),m=()=>{clearInterval(g),o(new DOMException("Aborted","AbortError"))};s.addEventListener("abort",m,{once:!0})})}async function E(r,s){return await new Promise((t,n)=>{const o=Math.floor(Math.random()*800)+400,a=setTimeout(()=>{Math.random()<.2?n(new Error("Server failed to delete.")):t()},o),d=()=>{clearTimeout(a),n(new DOMException("Aborted","AbortError"))};s.addEventListener("abort",d,{once:!0})})}function be(){return e.jsxs(y,{upload:N,children:[e.jsx(_,{className:"cursor-pointer rounded-lg border px-3 py-2",children:"Select Image"}),e.jsx(w,{})]})}const he=Object.freeze(Object.defineProperty({__proto__:null,default:be},Symbol.toStringTag,{value:"Module"}));function ve(){return e.jsx("div",{children:e.jsxs(y,{upload:N,onRemove:E,children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsx(_,{className:"rounded-lg border px-3 py-2",children:"Add files"})}),e.jsx(w,{render:({items:r})=>e.jsx("div",{className:"mt-4 grid grid-cols-2 gap-3 sm:grid-cols-3 md:grid-cols-4",children:r.map(s=>e.jsxs("div",{className:"relative size-32 overflow-hidden rounded-xl border","data-state":s.status,children:[(s.url||s.previewUrl)&&e.jsx("img",{className:"size-full object-cover",src:s.url||s.previewUrl,alt:s.name}),["error","uploading"].includes(s.status)&&e.jsx("div",{className:"absolute inset-0 z-10 grid place-items-center bg-black/60 text-white",children:s.status==="error"?e.jsx(I,{className:"rounded bg-white/10 px-2 py-1 text-xs",uid:s.uid,children:"Retry"}):e.jsx("div",{className:"animate-spin text-lg",children:"○"})}),e.jsxs("div",{className:"absolute inset-x-0 bottom-0 z-20 flex gap-2 p-2",children:[e.jsx(W,{className:"rounded bg-white/60 px-2 py-1 text-xs",alwaysVisible:!0,uid:s.uid,children:"Cancel"}),e.jsx(H,{className:"rounded bg-white/90 px-2 py-1 text-xs",uid:s.uid,children:"Remove"})]})]},s.uid))})})]})})}const je=Object.freeze(Object.defineProperty({__proto__:null,default:ve},Symbol.toStringTag,{value:"Module"}));function ye(){const[r,s]=i.useState(null);return e.jsxs("form",{className:"space-y-4",onSubmit:t=>{t.preventDefault();const n=t.currentTarget,a=new FormData(n).get("product-images");s(a?String(a):"[]")},children:[e.jsxs(y,{name:"product-images",multiple:!0,upload:N,onRemove:E,children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(_,{className:"rounded-lg border px-3 py-2",children:"Add images"})}),e.jsx(w,{}),e.jsx(B,{})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("button",{type:"submit",className:"rounded-lg bg-black px-4 py-2 text-white dark:bg-white dark:text-black",children:"Submit"})}),r&&e.jsx("pre",{className:"mt-4 overflow-auto rounded-lg border bg-gray-50 p-3 text-xs dark:bg-neutral-900",children:r})]})}const _e=Object.freeze(Object.defineProperty({__proto__:null,default:ye},Symbol.toStringTag,{value:"Module"}));function we(){return e.jsx(y,{onRemove:E,upload:N,children:e.jsxs("div",{className:"grid grid-cols-[auto_1fr] items-center gap-4",children:[e.jsx(_,{asChild:!0,className:"p-3 rounded-lg border",children:e.jsx("button",{children:"Pick Files"})}),e.jsx(w,{render:({items:r,actions:s})=>e.jsx("div",{className:"flex gap-2",children:r.map(t=>e.jsxs("div",{className:"size-14 shadow relative",children:[["error","uploading"].includes(t.status)&&e.jsx(I,{className:"flex items-center justify-center absolute rounded w-full h-full z-10 inset-0 bg-black/60  text-white text-xs",uid:t.uid,children:t.status==="error"?"Retry":e.jsx("span",{className:"animate-spin font-semibold",children:"O"})}),e.jsx("img",{className:"object-cover rounded w-full h-full",src:t.url||t.previewUrl,alt:t.name},t.uid),e.jsx(W,{className:["bg-white cursor-pointer border rounded-full size-4 m-1text-black text-xs absolute top-1 right-1",t.status==="uploading"&&"z-20"].filter(Boolean).join(" "),asChild:!0,uid:t.uid,children:e.jsx("button",{children:"X"})}),e.jsx(H,{className:["cursor-pointer text-black text-xs",t.status==="removing"&&"opacity-50",t.status==="error"&&"text-red-600",t.status==="uploading"&&"hidden"].filter(Boolean).join(" "),uid:t.uid,children:"Remove"})]},t.uid))})})]})})}const Ne=Object.freeze(Object.defineProperty({__proto__:null,default:we},Symbol.toStringTag,{value:"Module"}));function ke(){return e.jsxs(y,{upload:N,onRemove:E,accept:"image/*",children:[e.jsx(me,{children:e.jsxs("div",{className:"rounded-xl border border-dashed p-8 text-center",children:[e.jsx("div",{className:"mb-2 text-sm font-medium",children:"Drag images here"}),e.jsx("div",{className:"text-xs opacity-70",children:"or"}),e.jsx("div",{className:"mt-3",children:e.jsx(_,{className:"rounded-lg border px-3 py-2",children:"Browse files"})})]})}),e.jsx(w,{})]})}const Ce=Object.freeze(Object.defineProperty({__proto__:null,default:ke},Symbol.toStringTag,{value:"Module"}));function Re(){return e.jsxs(y,{upload:N,onRemove:E,maxCount:3,accept:"image/*",children:[e.jsx(_,{render:({items:r})=>e.jsx("button",{type:"button",className:"rounded-lg border px-3 py-2","aria-label":"Select images",children:r.length>0?`Add more (${r.length}/3)`:"Select images"})}),e.jsx(w,{})]})}const Ue=Object.freeze(Object.defineProperty({__proto__:null,default:Re},Symbol.toStringTag,{value:"Module"}));function Me(){return e.jsxs(y,{upload:N,onRemove:E,removeMode:"strict",name:"product-images",accept:"image/*",children:[e.jsx(_,{className:"rounded-lg border px-3 py-2",children:"Upload product photos"}),e.jsx(w,{render:({items:r,actions:s})=>e.jsx("div",{className:"mt-4 grid grid-cols-2 gap-3 sm:grid-cols-3",children:r.map(t=>e.jsxs("div",{className:"rounded-lg border p-2",children:[t.url||t.previewUrl?e.jsx("img",{className:"h-28 w-full rounded object-cover",src:t.url||t.previewUrl,alt:t.name}):e.jsx("div",{className:"flex h-28 items-center justify-center text-xs opacity-70",children:t.name}),t.status==="uploading"&&e.jsx("div",{className:"mt-2 h-1 bg-gray-200",children:e.jsx("div",{className:"h-full bg-black",style:{width:`${Math.max(0,Math.min(100,t.progress??0))}%`}})}),t.status==="removing"&&e.jsx("div",{className:"mt-1 text-xs opacity-70",children:"Deleting…"}),t.status==="error"&&e.jsx("div",{className:"mt-1 text-xs text-red-600",children:t.error??"Operation failed"}),e.jsxs("div",{className:"mt-2 flex gap-2",children:[t.status==="uploading"?e.jsx("button",{type:"button",onClick:()=>s.cancel(t.uid),className:"text-xs underline",children:"Cancel"}):e.jsx("button",{type:"button",onClick:()=>s.remove(t.uid),className:"text-xs underline",disabled:t.status==="removing",children:"Remove"}),(t.status==="error"||t.status==="canceled")&&e.jsx("button",{type:"button",onClick:()=>s.retry(t.uid),className:"text-xs underline",children:"Retry"})]})]},t.uid))})})]})}const Ee=Object.freeze(Object.defineProperty({__proto__:null,default:Me},Symbol.toStringTag,{value:"Module"}));function Pe(){return e.jsx(y,{upload:N,multiple:!1,accept:"image/*",name:"avatar",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"relative size-24 overflow-hidden rounded-full border",children:e.jsx(w,{render:({items:r,actions:s})=>e.jsxs("div",{className:"relative size-full",children:[r[0]&&e.jsx("img",{className:"size-full object-cover",src:r[0].url||r[0].previewUrl,alt:r[0].name}),r[0]&&r[0].status==="uploading"&&e.jsx("button",{type:"button",onClick:()=>s.cancel(r[0].uid),className:"absolute inset-0 grid place-items-center rounded-full bg-black/50 text-white",children:e.jsx("span",{className:"animate-spin",children:"○"})}),r[0]&&["error","canceled"].includes(r[0].status)&&e.jsx(I,{className:"absolute inset-0 grid place-items-center rounded-full bg-black/60 text-white",uid:r[0].uid,children:"Retry"})]})})}),e.jsx(_,{className:"rounded-lg border px-3 py-2",children:"Change avatar"})]})})}const Se=Object.freeze(Object.defineProperty({__proto__:null,default:Pe},Symbol.toStringTag,{value:"Module"}));function Oe(){return e.jsxs("form",{className:"max-w-md",children:[e.jsxs(y,{multiple:!0,name:"images",upload:N,children:[e.jsx(_,{render:({isUploading:r,totalProgress:s,items:t})=>e.jsxs("button",{type:"button",className:"inline-flex items-center gap-2 rounded-lg border px-3 py-2","data-loading":r||void 0,children:[r?`Uploading ${s??0}%`:"Select Images",e.jsxs("span",{className:"text-xs opacity-70",children:["(",t.length,")"]})]})}),e.jsx(w,{render:({items:r,actions:s})=>e.jsx("div",{className:"mt-4 grid grid-cols-2 gap-3 sm:grid-cols-3",children:r.map(t=>e.jsxs("div",{"data-state":t.status,className:"relative rounded-lg border p-2",children:[t.previewUrl||t.url?e.jsx("img",{src:t.previewUrl||t.url,alt:t.name,width:160,height:120,style:{objectFit:"cover",width:"100%",height:120}}):e.jsx("div",{className:"flex h-[120px] items-center justify-center text-xs opacity-70",children:t.name}),t.status==="uploading"&&e.jsx("div",{className:"mt-2 h-1 bg-gray-200 dark:bg-neutral-800",children:e.jsx("div",{className:"h-full bg-black dark:bg-white",style:{width:`${Math.max(0,Math.min(100,t.progress??0))}%`}})}),t.status==="error"&&e.jsx("div",{className:"mt-1 text-xs text-red-600",children:t.error??"Upload failed"}),e.jsxs("div",{className:"mt-2 flex gap-2",children:[t.status==="uploading"&&e.jsx("button",{type:"button",onClick:()=>s.cancel(t.uid),className:"text-xs underline",children:"Cancel"}),(t.status==="error"||t.status==="canceled")&&e.jsx("button",{type:"button",onClick:()=>s.retry(t.uid),className:"text-xs underline",children:"Retry"}),e.jsx("button",{type:"button",onClick:()=>s.remove(t.uid),className:"text-xs underline",children:"Remove"})]})]},t.uid))})}),e.jsx(B,{})]}),e.jsx("div",{className:"mt-6",children:e.jsx("button",{type:"submit",className:"rounded-lg bg-black px-4 py-2 text-white dark:bg-white dark:text-black",children:"Submit"})})]})}const ze=Object.freeze(Object.defineProperty({__proto__:null,default:Oe},Symbol.toStringTag,{value:"Module"})),Ae=Object.assign({"../examples/basic-example.tsx":he,"../examples/card-type-upload.tsx":je,"../examples/controlled-form.tsx":_e,"../examples/custom-example.tsx":Ne,"../examples/dropzone-showcase.tsx":Ce,"../examples/max-count-and-accept.tsx":Ue,"../examples/product-moderation.tsx":Ee,"../examples/spinner-avatar-upload.tsx":Se,"../examples/upload-example.tsx":ze});function De({componentKey:r,...s}){const n=Ae[r]?.default;return n?e.jsx("div",{className:"border p-4 border-gray-200 h-full min-h-64",children:e.jsx(n,{"client:only":"react",...s},r)}):e.jsx("div",{className:"p-4 border border-gray-200",children:e.jsx("p",{children:"Component not loaded"})})}export{De as default};
